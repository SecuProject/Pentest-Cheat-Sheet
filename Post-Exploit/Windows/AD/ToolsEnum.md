# ToolsEnum

- [ToolsEnum](#toolsenum)
  - [adPEAS](#adpeas)
  - [ADRecon](#adrecon)
  - [PingCastle](#pingcastle)
  - [PowerSploit](#powersploit)
    - [Commands](#commands)
    - [Source](#source)
  - [PowerView](#powerview)
    - [Commands](#commands-1)
      - [USERHUNTING](#userhunting)
- [Sources](#sources)

## adPEAS

Commands:

```powershell
powershell -ex bypass

Import-Module .\adPEAS.ps1
Invoke-adPEAS
```

Source:

    https://raw.githubusercontent.com/61106960/adPEAS/main/adPEAS.ps1

## ADRecon

Commands:

```powershell
powershell -ep bypass
.\ADRecon.ps1
.\ADRecon.ps1 -Protocol LDAP -DomainController DC_IP_ADDRESS -Credential pentest.lab\USERNAME
.\ADRecon.ps1 -Protocol ADWS -DomainController DC_IP_ADDRESS -Credential pentest.lab\USERNAME -Collect Domian, DCs
```

Source:

    https://raw.githubusercontent.com/sense-of-security/ADRecon/master/ADRecon.ps1


[Tools link (Git)](https://github.com/sense-of-security/ADRecon)

## PingCastle

Commands:

```
PingCastle.exe
```

Source:

    https://github.com/vletoux/pingcastle/releases/download/2.10.0.0/PingCastle_2.10.0.0.zip
## PowerSploit

### Commands  

Import script

```powershell
Import-Module .\PowerSploit.psd1
```

List module 

```powershell
Get-Command -Module PowerSploit
```

Exploit list 

```powershell
Get-ExploitableSystem -Verbose
```   


### Source

    https://github.com/PowerShellMafia/PowerSploit/archive/v3.0.0.zip


## PowerView

### Commands

Import script

```powershell
powershell -ep bypass
Import-Module .\Recon
```

List module 

```powershell
Get-Command -Module Recon
```

Other Commands:

```powershell
Get-NetDomain

Get-NetDomainController

Get-NetDomainTrust

Get-NetComputer

Get-NetComputer -OperatingSystem "Windows 7 Ultimate"

(Get-DomainPolicy).”system access”

Get-NetGroup *admin*

Get-NetGroupMember -GroupName "Domain Admins"

Get-UserProperty -Properties pwdlastset

Invoke-ShareFinder
```

#### USERHUNTING

```powershell
Find-LocalAdminAccess

Invoke-EnumerateLocalAdmin

Invoke-UserHunter
```

Source:

    https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon



# Sources

- https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-enumeration-with-powerview#get-netdomain
-  https://www.exploit-db.com/docs/english/46990-active-directory-enumeration-with-powershell.pdf
- https://book.hacktricks.xyz/windows/basic-powershell-for-pentesters/powerview