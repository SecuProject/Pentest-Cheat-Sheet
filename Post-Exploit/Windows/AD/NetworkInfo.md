# Network discovery

## Domain Scan

```powershell
1..254 | % { nslookup 192.168.1."$_"}
```

## Ping

```powershell
1..254 | ForEach-Object {Test-Connection -ComputerName "192.168.0.$_" -Count 1 -ErrorAction SilentlyContinue}
```

## Reverse Lookup

```powershell
(1..254) | % {$ip="192.168.0.$_"; Write-output "$IP  $( Resolve-DnsName $ip -ErrorAction Ignore |select -exp NameHost )  "}
```

## DNS resolv

```powershell
1..254 | % {resolve-dnsname "192.168.59.$_" -Server 192.168.59.1 -ErrorAction SilentlyContinue} | SELECT Name,Section,NameHost |Select-String -Pattern "Answer"
```

## Portscan

```powershell
Test-NetConnection -ComputerName www.thomasmaurer.ch -Port 80
```

## NAT detection

Batch

```batch
tracert 8.8.8.8
```

Powershell

```powershell
Test-NetConnection 8.8.8.8 â€“TraceRoute
```

## Adapter info and vlan

```powershell
Get-NetAdapter | ft Name, Status, Linkspeed, VlanID
```

## Dnsache

```powershell
Get-DnsClientCache
```

## Route

```powershell
Get-NetRoute -Protocol Local -DestinationPrefix 192.168*
```

## Netstat

Batch

```batch
netstat -a
```

Powershell

```powershell
Get-NetTCPConnection -State Established
Get-NetTCPConnection -State Listen
```

## SMB

```powershell
Get-SmbConnection

Get-SmbOpenFile
```

## Hyper-V Networking

```powershell
Get-NetAdapterVmq
```

## DHCP

Get DHCP Servers

```powershell
Get-DhcpServerInDC
```

DHCP Ranges

```powershell
Get-DhcpServerv4Scope -ComputerName myDC01
```

## Port scan

wget <https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/Invoke-Portscan.ps1>

```powershell
powershell -ep bypass
Import-Module .\Invoke-Portscan.ps1
Invoke-Portscan -Hosts IP_ADDRESS -TopPorts 50 -oA stuff
```

## Source

<https://www.hackingarticles.in/netbios-and-smb-penetration-testing-on-windows/>
