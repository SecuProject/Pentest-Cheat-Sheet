# SNMP

Default port: `161/udp,162/udp`

Default port over TLS: `10161/udp,10162/udp`

**Summery:**

- [SNMP](#snmp)
  - [Recon](#recon)
  - [Enumerates SNMP](#enumerates-snmp)
    - [Enumerate specific Windows OID](#enumerate-specific-windows-oid)
    - [Filter output](#filter-output)
  - [MSF](#msf)
  - [SNMP Brutforce](#snmp-brutforce)
  - [Medusa](#medusa)
  - [Source](#source)

Note: SNMP version `1`, `2` and `2c` does not offer traffic encryption!

## Recon

> nmap

```sh
nmap -sU -p 161,162 TARGET_IP
```

> snmpcheck

```sh
snmpcheck -p 161 TARGET_IP
```

## Enumerates SNMP

> public

```sh
snmpwalk -v1 -c public TARGET_IP
snmpwalk -v2c -c public IP_ADDRESS
ET-SNMP-EXTEND-MIB::nsExtendOutputFull
```

> cisco

```sh
snmpwalk -v2c -c cisco1234 IP_ADDRESS
```

> Others

```sh
snmpget -v1 -c public TARGET_IP
snmpcheck -c public -t TARGET_IP 
snmpbulkwalk -v2c -c public -Cn0 -Cr10 TARGET_IP
snmpenum -t TARGET_IP
snmpbw.pl TARGET_IP public 2 4
```

### Enumerate specific Windows OID

Running processes:

```sh
snmpwalk -v1 -c public TARGET_IP 1.3.6.1.2.1.25.4.2.1.2
```

Open TCP ports:

```sh
snmpwalk -v1 -c public TARGET_IP 1.3.6.1.2.1.6.13.1.3
```

Install software:

```sh
snmpwalk -v1 -c public TARGET_IP 1.3.6.1.2.1.25.6.3.1.2
```

### Filter output

```sh
grep ".1.3.6.1.2.1.1.1.0" OUTPUT_FILE
```

```sh
grep -i "trap" OUTPUT_FILE
```

```sh
grep -i "fail" OUTPUT_FILE
```

## MSF

```ruby
use auxiliary/scanner/snmp/snmp_enum
set RHOSTS TARGET_IP
run
```

## SNMP Brutforce

```ruby
use auxiliary/scanner/snmp/snmp_login
set RHOSTS TARGET_IP
set PASS_FILE <dico>
set STOP_ON_SUCCESS true
set BLANK_PASSWORDS false
set THREAD 10
run
```

## Medusa

```sh
medusa -h TARGET_IP -u admin -P WORDLIST -M snmp
```

## Source

- <https://github.com/dheiland-r7/snmp/blob/master/snmpbw.pl>
- <https://book.hacktricks.xyz/pentesting/pentesting-snmp>
