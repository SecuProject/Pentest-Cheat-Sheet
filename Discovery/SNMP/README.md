# SNMP

Default port: `161/udp,162/udp`

Default port over TLS: `10161/udp,10162/udp`

**Summery:**

- [SNMP](#snmp)
  - [Recon](#recon)
  - [Enumerates SNMP](#enumerates-snmp)
    - [Enumerate specific Windows OID](#enumerate-specific-windows-oid)
    - [Filter output](#filter-output)
  - [MSF](#msf)
  - [SNMP Brutforce](#snmp-brutforce)
  - [Medusa](#medusa)
  - [Source](#source)

Note: SNMP version `1`, `2` and `2c` does not offer traffic encryption!

## Recon

> nmap

```sh
nmap -sU -p 161,162 IP_ADDRESS
```

> snmpcheck

```sh
snmpcheck -p 161 IP_ADDRESS
```

## Enumerates SNMP

> public

```sh
snmpwalk -v1 -c public IP_ADDRESS
snmpwalk -v2c -c public IP_ADDRESS
```

> cisco

```sh
snmpwalk -v2c -c cisco1234 IP_ADDRESS
```

> onesixtyone

community.lst

```community
public
private
manager
cisco1234
```

```bash
onesixtyone -c community.lst IP_ADDRESS
onesixtyone -c community.lst -i host.lst
```

> Others

```sh
snmpget -v1 -c public IP_ADDRESS
snmpcheck -c public -t IP_ADDRESS 
snmpbulkwalk -v2c -c public -Cn0 -Cr10 IP_ADDRESS
snmpenum -t IP_ADDRESS
snmpbw.pl IP_ADDRESS public 2 4
```

### Enumerate specific Windows OID

Running processes:

```sh
snmpwalk -v1 -c public IP_ADDRESS 1.3.6.1.2.1.25.4.2.1.2
```

Open TCP ports:

```sh
snmpwalk -v1 -c public IP_ADDRESS 1.3.6.1.2.1.6.13.1.3
```

Install software:

```sh
snmpwalk -v1 -c public IP_ADDRESS 1.3.6.1.2.1.25.6.3.1.2
```

Windows Users:

```sh
snmpwalk -v1 -c public IP_ADDRESS 1.3.6.1.4.1.77.1.2.25
```

### Filter output

```sh
grep ".1.3.6.1.2.1.1.1.0" OUTPUT_FILE
```

```sh
grep -i "trap" OUTPUT_FILE
```

```sh
grep -i "fail" OUTPUT_FILE
```

## MSF

```ruby
use auxiliary/scanner/snmp/snmp_enum
set RHOSTS IP_ADDRESS
run
```

## SNMP Brutforce

```ruby
use auxiliary/scanner/snmp/snmp_login
set RHOSTS IP_ADDRESS
set PASS_FILE /usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt
set STOP_ON_SUCCESS true
set BLANK_PASSWORDS false
set THREAD 10
run
```

## Medusa

```sh
medusa -h IP_ADDRESS -u admin -P WORDLIST -M snmp
```

## Source

- <https://github.com/dheiland-r7/snmp/blob/master/snmpbw.pl>
- <https://book.hacktricks.xyz/pentesting/pentesting-snmp>
