# POP/POP3

Default port: `110/tcp`

Default Encrypted port: `995/tcp`

## Recon

```sh
nc -nv TARGET_IP 110
openssl s_client -connect TARGET_IP:995 -crlf -quiet
nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -port 110,995 TARGET_IP
```

### METASPLOIT

```ruby
msf > use auxiliary/scanner/pop3/pop3_version
msf auxiliary(pop3_version) > set RHOSTS TARGET_IP_RANGE
msf auxiliary(pop3_version) > set THREADS 20
msf auxiliary(pop3_version) > run
```

## Connect server

Login to server:

### nc

```sh
nc -nv TARGET_IP 110

    USER USERNAME
    PASS PASSWORD
```

### Telnet

```sh
telnet TARGET_IP 110
```

POP commands:

|Commands|Description|
|-|-|
|USER uid|Log in as "uid"|
|PASS password|Substitue "password" for your actual password|
|STAT|List number of messages, total mailbox size|
|LIST|List messages and sizes|
|RETR n|Show message n|
|DELE n|Mark message n for deletion|
|RSET|Undo any changes|
|QUIT|Logout (expunges messages if no RSET)|
|TOP msg n|Show first n lines of message number msg|
|CAPA|Get capabilities|

## Crack password

```sh
hydra -V -L username.lst -P password.lst -f TARGET_IP pop3
```

## Sources

- <https://book.hacktricks.xyz/network-services-pentesting/pentesting-pop>
- <https://www.offensive-security.com/metasploit-unleashed/scanner-pop3-auxiliary-modules/>
