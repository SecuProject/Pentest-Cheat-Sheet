# First steps

**Summery:**

- [First steps](#first-steps)
  - [1. Port Scan](#1-port-scan)
  - [2. Version detection/banner grabbing](#2-version-detectionbanner-grabbing)
  - [3. Service Analyses](#3-service-analyses)
  - [Notes](#notes)
    - [Nmap scripts Path](#nmap-scripts-path)
    - [Add nmap vuln script](#add-nmap-vuln-script)

## 1. Port Scan

It is advisable to scan the ports of the target host and save the results in a file:

```sh
mkdir PortScanResults
```

> Fast scan

```sh
nmap -F -oA PortScanResults/QuickScan TARGET_IP
```

> Medium scan

```sh
nmap -oA PortScanResults/MediumScan TARGET_IP
```

> Full port scan

```sh
nmap -p- -v -oA PortScanResults/FullScan TARGET_IP
sudo masscan -i INTERFACE --rate=1000 --ports 0-65535 -oL PortScanResults/FullScan.lst TARGET_IP
```

## 2. Version detection/banner grabbing

```sh
nmap -sV -sC -oA PortScanResults/VersionScan TARGET_IP
```

> Detect vulnerability

```sh
nmap -sV -sC --script vuln -oA nmap/VulnScan TARGET_IP
```

> OS enumeration

```sh
nmap -sV -sC -O -oA PortScanResults/OsScan TARGET_IP
nmap -p 445 --script=smb-os-discovery -oA PortScanResults/OsSmbScan TARGET_IP
```

## 3. Service Analyses

> Searchspoit

```sh
searchpoit SERVICE_NAME
```

> Update searchspoit db

```sh
searchsploit -u
```

## Notes

### Nmap scripts Path

```sh
/usr/share/nmap/scripts
```

Get script information:

```sh
cat /usr/share/nmap/scripts/script.db
grep exploit /usr/share/nmap/scripts/script.db
```

### Add nmap vuln script

```sh
mkdir /tmp/nse-scripts
git clone https://github.com/psc4re/NSE-scripts.git -o /tmp/nse-scripts
# SMBGhost
sudo mv /tmp/nse-scripts/cve-2020-0796.nse /usr/share/nmap/scripts/smb-vuln-cve-2020-0796.nse
# SIGRed
sudo mv /tmp/nse-scripts/cve-2020-1350.nse /usr/share/nmap/scripts/dns-cve-2020-1350.nse
sudo mv /tmp/nse-scripts/CVE-2021-21972.nse /usr/share/nmap/scripts/vsphere-cve-2021-21972.nse
sudo mv /tmp/nse-scripts/proxyshell.nse /usr/share/nmap/scripts/proxyshell.nse
sudo nmap --script-updatedb
```
