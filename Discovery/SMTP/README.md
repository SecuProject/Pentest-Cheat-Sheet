# SMTP - 25

Default port: `25/tcp`

## Nmap scan  

```sh
nmap --script smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p 25 IP_ADDRESS
```

## Grab banner

```sh
nc -nvv TARGET_IP 25

telnet TARGET_IP 25
```

## User enum  

### Msf

```sh
use auxiliary/scanner/smtp/smtp_enum
set RHOSTS TARGET_IP
run 
```

### smtp-user-enum

> mode

```sh
VRFY -> confirm the existance of names of valid users.
RCPT -> 
```

> Command

```sh
smtp-user-enum.pl -M VRFY -D doamin.com -U USER_LIST -t TARGET_IP

smtp-user-enum.pl -M RCPT -D doamin.com -U USER_LIST -t TARGET_IP
```

## Send email

```sh
swaks --to USER@DOMAIN.COM --from USER@DOMAIN.COM --header "Subject: Credentials / Errors" --body "TEST" --server DOMAIN.COM
```

## Connect Client

```sh
evolution
```
